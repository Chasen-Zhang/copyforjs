# name: Node.js Package
# on:
#   push:
#     branches:
#       - main

# jobs:
#   main:
#     runs-on: ubuntu-latest
#     steps:
#       - name: Checkout
#         uses: actions/checkout@v2
#       - name: Setup Node
#         uses: actions/setup-node@v2
#         with:
#           node-version: '14.x'
#           registry-url: 'https://registry.npmjs.org'
#       - name: Install dependencies and build ðŸ”§
#         run: npm install && npm run build
#       - name: Publish package on NPM ðŸ“¦
#         run: npm publish --@chasen_:registry=https://npm.pkg.github.com/
#         env:
#           NODE_AUTH_TOKEN: ${{ secrets.NPM_AUTH_TOKEN }}

name: Public Npm

on:
  push:
    branches: [ main ]

jobs:
  publish:
    runs-on: ubuntu-latest

    name: 'publish npm'

    environment: npm

    steps:
      - uses: actions/checkout@master

      - name: Install and Build 
        run: |
          yarn install
          yarn run build

      - name: 'Publish to the npm registry'
        uses: primer/publish@3.0.0
        env:
          GITHUB_TOKEN: ${{ secrets.COPY_GITHUB_TOKEN }}
          NPM_AUTH_TOKEN: ${{ secrets.NPM_AUTH_TOKEN }}
        with:
          default_branch: 'main'
